{"version":3,"file":"DTooltip.stories-0c1063e4.js","sources":["../../src/d-tooltip/DTooltip.vue"],"sourcesContent":["<template>\n  <d-box\n    class=\"ui-tooltip-wrapper\"\n    @click=\"handleClick\"\n    @mouseenter=\"handleMouseEnter\"\n    @mouseleave=\"handleMouseLeave\"\n  >\n    <d-box ref=\"targetRef\" class=\"ui-tooltip-target\">\n      <slot></slot>\n    </d-box>\n    <d-box ref=\"tooltipRef\" class=\"ui-tooltip\" :class=\"{ hidden }\">\n      {{ tooltip }}\n      <d-box class=\"ui-tooltip__arrow\" ref=\"arrowRef\"></d-box>\n    </d-box>\n  </d-box>\n</template>\n\n<script setup>\nimport { DBox } from \"../main\";\nimport { ref, onMounted, onUnmounted } from \"vue\";\nimport { arrow, computePosition, flip, offset, shift } from \"@floating-ui/dom\";\n\nconst props = defineProps({\n  tooltip: {\n    type: String,\n  },\n  trigger: {\n    type: String,\n    validator: (value) => [\"click\", \"hover\"].includes(value),\n    default: \"hover\",\n  },\n  timeout: {\n    type: Number,\n    default: 3,\n  },\n});\n\nconst targetRef = ref(null);\nconst tooltipRef = ref(null);\nconst arrowRef = ref(null);\nconst hidden = ref(true);\n\nconst updateTooltip = () => {\n  computePosition(targetRef.value.$el, tooltipRef.value.$el, {\n    placement: \"top\",\n    middleware: [\n      offset(6),\n      flip(),\n      shift({ padding: 5 }),\n      arrow({ element: arrowRef.value.$el }),\n    ],\n  }).then(({ x, y, placement, middlewareData }) => {\n    Object.assign(tooltipRef.value.$el.style, {\n      left: `${x}px`,\n      top: `${y}px`,\n    });\n\n    const { x: arrowX, y: arrowY } = middlewareData.arrow;\n\n    const staticSide = {\n      top: \"bottom\",\n      right: \"left\",\n      bottom: \"top\",\n      left: \"right\",\n    }[placement.split(\"-\")[0]];\n\n    Object.assign(arrowRef.value.$el.style, {\n      left: arrowX != null ? `${arrowX}px` : \"\",\n      top: arrowY != null ? `${arrowY}px` : \"\",\n      right: \"\",\n      bottom: \"\",\n      [staticSide]: \"-4px\",\n    });\n  });\n};\n\nconst removeOnClickOutside = (e) => {\n  if (!e.target.closest(\".ui-tooltip-wrapper\") && props.trigger === \"click\") {\n    hidden.value = true;\n  }\n};\n\nconst handleClick = (e) => {\n  if (e.target.closest(\".ui-tooltip-wrapper\")) {\n    if (hidden.value && props.trigger === \"click\") {\n      hidden.value = false;\n      updateTooltip();\n      if (props.timeout && props.timeout > 0) {\n        setTimeout(() => {\n          hidden.value = true;\n        }, props.timeout * 1000);\n      }\n    }\n  }\n};\n\nconst handleMouseEnter = () => {\n  if (hidden.value && props.trigger === \"hover\") {\n    hidden.value = false;\n    updateTooltip();\n  }\n};\n\nconst handleMouseLeave = () => {\n  if (!hidden.value && props.trigger === \"hover\") {\n    hidden.value = true;\n  }\n};\n\nonMounted(() => {\n  updateTooltip();\n  window.addEventListener(\"click\", removeOnClickOutside);\n});\n\nonUnmounted(() => {\n  window.removeEventListener(\"click\", removeOnClickOutside);\n});\n</script>\n\n<style lang=\"scss\">\n.ui-tooltip {\n  background: #222;\n  color: white;\n  font-weight: bold;\n  padding: 5px;\n  border-radius: 4px;\n  font-size: 90%;\n  width: max-content;\n  position: absolute;\n  top: 0;\n  left: 0;\n  &.hidden {\n    display: none;\n  }\n}\n.ui-tooltip-target {\n  display: inline-block;\n}\n.ui-tooltip__arrow {\n  position: absolute;\n  background: #222;\n  width: 8px;\n  height: 8px;\n  transform: rotate(45deg);\n}\n</style>\n"],"names":["targetRef","ref","tooltipRef","arrowRef","hidden","updateTooltip","__name","computePosition","offset","flip","shift","arrow","x","y","placement","middlewareData","arrowX","arrowY","staticSide","removeOnClickOutside","e","props","handleClick","handleMouseEnter","handleMouseLeave","onMounted","onUnmounted"],"mappings":"4fAqCMA,EAAYC,EAAI,IAAI,EACpBC,EAAaD,EAAI,IAAI,EACrBE,EAAWF,EAAI,IAAI,EACnBG,EAASH,EAAI,EAAI,EAEjBI,EAAgBC,EAAA,IAAM,CAC1BC,EAAgBP,EAAU,MAAM,IAAKE,EAAW,MAAM,IAAK,CACzD,UAAW,MACX,WAAY,CACVM,EAAO,CAAC,EACRC,EAAM,EACNC,EAAM,CAAE,QAAS,EAAG,EACpBC,EAAM,CAAE,QAASR,EAAS,MAAM,GAAG,CAAE,CACtC,CACL,CAAG,EAAE,KAAK,CAAC,CAAE,EAAAS,EAAG,EAAAC,EAAG,UAAAC,EAAW,eAAAC,KAAqB,CAC/C,OAAO,OAAOb,EAAW,MAAM,IAAI,MAAO,CACxC,KAAM,GAAGU,MACT,IAAK,GAAGC,KACd,CAAK,EAED,KAAM,CAAE,EAAGG,EAAQ,EAAGC,CAAQ,EAAGF,EAAe,MAE1CG,EAAa,CACjB,IAAK,SACL,MAAO,OACP,OAAQ,MACR,KAAM,OACP,EAACJ,EAAU,MAAM,GAAG,EAAE,CAAC,CAAC,EAEzB,OAAO,OAAOX,EAAS,MAAM,IAAI,MAAO,CACtC,KAAMa,GAAU,KAAO,GAAGA,MAAa,GACvC,IAAKC,GAAU,KAAO,GAAGA,MAAa,GACtC,MAAO,GACP,OAAQ,GACR,CAACC,CAAU,EAAG,MACpB,CAAK,CACL,CAAG,CACH,EAhCsB,iBAkChBC,EAAuBb,EAACc,GAAM,CAC9B,CAACA,EAAE,OAAO,QAAQ,qBAAqB,GAAKC,EAAM,UAAY,UAChEjB,EAAO,MAAQ,GAEnB,EAJ6B,wBAMvBkB,EAAchB,EAACc,GAAM,CACrBA,EAAE,OAAO,QAAQ,qBAAqB,GACpChB,EAAO,OAASiB,EAAM,UAAY,UACpCjB,EAAO,MAAQ,GACfC,IACIgB,EAAM,SAAWA,EAAM,QAAU,GACnC,WAAW,IAAM,CACfjB,EAAO,MAAQ,EACzB,EAAWiB,EAAM,QAAU,GAAI,EAI/B,EAZoB,eAcdE,EAAmBjB,EAAA,IAAM,CACzBF,EAAO,OAASiB,EAAM,UAAY,UACpCjB,EAAO,MAAQ,GACfC,IAEJ,EALyB,oBAOnBmB,EAAmBlB,EAAA,IAAM,CACzB,CAACF,EAAO,OAASiB,EAAM,UAAY,UACrCjB,EAAO,MAAQ,GAEnB,EAJyB,oBAMzB,OAAAqB,EAAU,IAAM,CACdpB,IACA,OAAO,iBAAiB,QAASc,CAAoB,CACvD,CAAC,EAEDO,EAAY,IAAM,CAChB,OAAO,oBAAoB,QAASP,CAAoB,CAC1D,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}