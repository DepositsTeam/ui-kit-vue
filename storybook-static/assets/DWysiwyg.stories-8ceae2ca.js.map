{"version":3,"file":"DWysiwyg.stories-8ceae2ca.js","sources":["../../src/d-wysiwyg/KnockOffWyswig.vue"],"sourcesContent":["<template>\n  <div class=\"ui-wysiwyg__wrapper\">\n    <label v-if=\"!!label\">\n      <p\n        class=\"ui-text-field__label\"\n        :class=\"labelClass\"\n        scale=\"subhead\"\n        :font-face=\"labelFontFace\"\n      >\n        {{ label }}\n      </p>\n    </label>\n    <div :class=\"{ focused }\" class=\"d-wysiwyg-semantic-container\">\n      <div :class=\"{ focused }\" class=\"d-wysisyg-controls\" v-if=\"editor\">\n        <p\n          @click=\"editor.commands.toggleHeading({ level: 1 })\"\n          :class=\"{ 'is-active': editor.isActive('heading', { level: 1 }) }\"\n        >\n          Title\n        </p>\n\n        <div id=\"headings\">\n          <div id=\"headings-visible\" @click=\"toggleOptions\">\n            {{ selectedHeading }}\n          </div>\n          <div v-if=\"showOptions\" id=\"heading-options\">\n            <div\n              v-for=\"(heading, index) in availableHeadings\"\n              :key=\"`heading-${index}`\"\n              class=\"heading-option\"\n              @click=\"editor.commands.toggleHeading({ level: heading })\"\n            >\n              H{{ heading }}\n            </div>\n          </div>\n        </div>\n\n        <button\n          @click=\"editor.chain().focus().setTextAlign('left').run()\"\n          :class=\"{ 'is-active': editor.isActive({ textAlign: 'left' }) }\"\n        >\n          <text-align-left-icon />\n        </button>\n        <button\n          @click=\"editor.chain().focus().setTextAlign('center').run()\"\n          :class=\"{ 'is-active': editor.isActive({ textAlign: 'center' }) }\"\n        >\n          <center-align-icon />\n        </button>\n        <button\n          @click=\"editor.chain().focus().setTextAlign('right').run()\"\n          :class=\"{ 'is-active': editor.isActive({ textAlign: 'right' }) }\"\n        >\n          <right-align-icon />\n        </button>\n        <button\n          @click=\"editor.chain().focus().setTextAlign('justify').run()\"\n          :class=\"{ 'is-active': editor.isActive({ textAlign: 'justify' }) }\"\n        >\n          <justify-align-icon />\n        </button>\n        <button\n          @click=\"editor.chain().focus().toggleBold().run()\"\n          :class=\"{ 'is-active': editor.isActive('bold') }\"\n        >\n          <text-bold-icon />\n        </button>\n        <button\n          @click=\"editor.chain().focus().toggleItalic().run()\"\n          :class=\"{ 'is-active': editor.isActive('italic') }\"\n        >\n          <text-italic-icon />\n        </button>\n        <button\n          @click=\"editor.chain().focus().toggleUnderline().run()\"\n          :class=\"{ 'is-active': editor.isActive('underline') }\"\n        >\n          <text-underline-icon />\n        </button>\n        <button\n          @click=\"editor.chain().focus().toggleBulletList().run()\"\n          :class=\"{ 'is-active': editor.isActive('bulletList') }\"\n        >\n          <list-icon />\n        </button>\n        <button\n          @click=\"editor.chain().focus().toggleBlockquote().run()\"\n          :class=\"{ 'is-active': editor.isActive('blockquote') }\"\n        >\n          <block-quote-icon />\n        </button>\n        <button\n          @click=\"editor.chain().focus().toggleCode().run()\"\n          :class=\"{ 'is-active': editor.isActive('code') }\"\n        >\n          <document-code-outline-icon />\n        </button>\n        <button @click=\"addImage\">\n          <image-icon />\n        </button>\n        <button\n          @click=\"toggleLink\"\n          :class=\"{ 'is-active': editor.isActive('link') }\"\n        >\n          <link-outline-icon />\n        </button>\n        <button @click=\"editor.chain().focus().undo().run()\">\n          <undo-outline-icon />\n        </button>\n        <button @click=\"editor.chain().focus().redo().run()\">\n          <redo-outline-icon />\n        </button>\n      </div>\n      <editor-content\n        :class=\"{ focused }\"\n        class=\"d-wysiwyg-editor\"\n        :editor=\"editor\"\n      />\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport {\n  TextBoldIcon,\n  TextItalicIcon,\n  TextUnderlineIcon,\n  BlockQuoteIcon,\n  ListIcon,\n  UndoOutlineIcon,\n  RedoOutlineIcon,\n  DocumentCodeOutlineIcon,\n  ImageIcon,\n  LinkOutlineIcon,\n  TextAlignLeftIcon,\n  RightAlignIcon,\n  CenterAlignIcon,\n  JustifyAlignIcon,\n} from \"../main\";\nimport { Editor, EditorContent } from \"@tiptap/vue-3\";\nimport Underline from \"@tiptap/extension-underline\";\nimport StarterKit from \"@tiptap/starter-kit\";\nimport Code from \"@tiptap/extension-code\";\nimport Link from \"@tiptap/extension-link\";\nimport Placeholder from \"@tiptap/extension-placeholder\";\nimport TextAlign from \"@tiptap/extension-text-align\";\nimport Image from \"@tiptap/extension-image\";\nimport Heading from \"@tiptap/extension-heading\";\nimport {\n  ref,\n  watch,\n  onMounted,\n  onUnmounted,\n  onBeforeUnmount,\n  computed,\n} from \"vue\";\n\nconst emit = defineEmits([\"update:modelValue\"]);\n\nconst editor = ref(null);\nconst focused = ref(false);\n\nconst props = defineProps({\n  modelValue: {\n    type: String,\n    default: \"\",\n  },\n  label: {\n    type: String,\n  },\n  labelClass: {\n    type: [String, Array, Object],\n  },\n  fontFace: {\n    type: String,\n  },\n  labelFontFace: {\n    type: String,\n  },\n  placeholder: {\n    type: String,\n    default: \"Type content here\",\n  },\n});\n\nconst showOptions = ref(false);\n\nonMounted(() => {\n  window.addEventListener(\"click\", checkClicks);\n});\n\nonUnmounted(() => {\n  window.removeEventListener(\"click\", checkClicks);\n});\n\nconst toggleOptions = () => {\n  showOptions.value = !showOptions.value;\n};\n\nconst checkClicks = (e) => {\n  if (showOptions.value && !e.target.closest(\"#headings\")) {\n    showOptions.value = false;\n  }\n};\n\nwatch(\n  () => props.modelValue,\n  (value) => {\n    // HTML\n    const isSame = editor.value.getHTML() === value;\n\n    // JSON\n    // const isSame = JSON.stringify(this.editor.getJSON()) === JSON.stringify(value)\n\n    if (isSame) {\n      return;\n    }\n\n    editor.value.commands.setContent(value, false);\n  }\n);\n\nonMounted(() => {\n  editor.value = new Editor({\n    content: \"\",\n    extensions: [\n      StarterKit,\n      Underline,\n      Link,\n      Code,\n      Image,\n      Placeholder.configure({\n        placeholder: props.placeholder,\n      }),\n      TextAlign.configure({\n        types: [\"heading\", \"paragraph\"],\n      }),\n      Heading.configure({\n        levels: [1, 2, 3, 4, 5, 6],\n      }),\n    ],\n    onUpdate: () => {\n      // HTML\n      emit(\"update:modelValue\", editor.value.getHTML());\n\n      // JSON\n      // this.$emit('update:modelValue', this.editor.getJSON())\n    },\n    onFocus: () => {\n      // The editor state has changed.\n      focused.value = true;\n    },\n    onBlur: () => {\n      // The editor isnâ€™t focused anymore.\n      focused.value = false;\n    },\n  });\n});\n\nonBeforeUnmount(() => {\n  editor.value.destroy();\n});\n\nconst availableHeadings = [2, 3, 4, 5, 6];\n\nconst toggleFocusClass = (val) => {\n  focused.value = val;\n};\n\nconst addImage = () => {\n  const url = window.prompt(\"Enter your image URL\");\n\n  if (url) {\n    editor.value.chain().focus().setImage({ src: url }).run();\n  }\n};\n\nconst toggleLink = () => {\n  if (editor.value.isActive(\"link\")) {\n    editor.value.chain().focus().unsetLink().run();\n  } else {\n    const previousUrl = editor.value.getAttributes(\"link\").href;\n    const url = window.prompt(\"URL\", previousUrl);\n\n    // cancelled\n    if (url === null) {\n      return;\n    }\n\n    // empty\n    if (url === \"\") {\n      editor.value.chain().focus().extendMarkRange(\"link\").unsetLink().run();\n\n      return;\n    }\n\n    // update link\n    editor.value\n      .chain()\n      .focus()\n      .extendMarkRange(\"link\")\n      .setLink({ href: url })\n      .run();\n  }\n};\n\nconst selectedHeading = computed(() => {\n  if (editor.value.isActive(\"heading\", { level: 1 })) {\n    return \"H1\";\n  } else if (editor.value.isActive(\"heading\", { level: 2 })) {\n    return \"H2\";\n  } else if (editor.value.isActive(\"heading\", { level: 3 })) {\n    return \"H3\";\n  } else if (editor.value.isActive(\"heading\", { level: 4 })) {\n    return \"H4\";\n  } else if (editor.value.isActive(\"heading\", { level: 5 })) {\n    return \"H5\";\n  } else if (editor.value.isActive(\"heading\", { level: 6 })) {\n    return \"H6\";\n  } else {\n    return \"H2\";\n  }\n});\n</script>\n\n<style lang=\"scss\" scoped>\n.ui-wysiwyg__wrapper {\n  font-family: sans-serif;\n  &.dark_mode {\n    .ui-text-field__label {\n      color: var(--dark-input-label-color);\n    }\n  }\n}\n.d-wysisyg-controls {\n  width: 100%;\n  display: flex;\n  border: 1px solid #ced6de;\n  border-radius: 4px 4px 0 0;\n  scrollbar-width: none; /* Firefox */\n  -ms-overflow-style: none; /* Internet Explorer 10+ */\n  justify-content: center;\n\n  & > * {\n    margin-right: 8px;\n  }\n\n  &::-webkit-scrollbar {\n    /* WebKit */\n    width: 0;\n    height: 0;\n  }\n  &.focused {\n    border-color: var(--light-primary-action-color);\n  }\n  button {\n    background: transparent;\n    border: none;\n    color: #5f6b7a;\n    cursor: pointer;\n    &:hover,\n    &.is-active {\n      color: var(--light-primary-action-color);\n    }\n  }\n}\n.d-wysiwyg-editor {\n  padding: 8px 16px;\n  border: 1px solid #ced6de;\n  border-radius: 0 0 4px 4px;\n  min-height: 150px;\n  &.focused {\n    border-color: var(--light-primary-action-color);\n  }\n}\n.d-wysiwyg-semantic-container {\n  border-radius: 4px;\n  box-shadow: 0px 1px 2px rgba(63, 63, 68, 0.1);\n  &:hover {\n    & > div {\n      border-color: var(--light-primary-action-color);\n    }\n  }\n  &.focused {\n    box-shadow: 0 0 0 3px var(--light-primary-action-box-shadow-color);\n  }\n  &.dark_mode {\n    .d-wysiwyg-editor {\n      background-color: var(--dark-input-background-color);\n      border-color: var(--dark-input-border-color);\n      color: #fff;\n    }\n    .d-wysisyg-controls {\n      background-color: var(--dark-input-background-color);\n      border-color: var(--dark-input-border-color);\n      button {\n        color: #cbd5e1;\n        &.is-active {\n          color: var(--dark-primary-action-color);\n        }\n      }\n    }\n  }\n}\n</style>\n\n<style lang=\"scss\">\n.ProseMirror-focused {\n  border-color: transparent;\n  outline-color: transparent;\n}\n/* Placeholder (at the top) */\n.ProseMirror p.is-editor-empty:first-child::before {\n  content: attr(data-placeholder);\n  float: left;\n  color: #b8c4ce;\n  pointer-events: none;\n  height: 0;\n}\n.ProseMirror.ProseMirror-focused {\n  outline: none;\n  border: none;\n}\n\n.ProseMirror {\n  > * + * {\n    margin-top: 0.75em;\n  }\n\n  img {\n    max-width: 100%;\n    height: auto;\n\n    &.ProseMirror-selectednode {\n      outline: 3px solid var(--light-primary-action-color);\n    }\n  }\n}\n#headings {\n  position: relative;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  #heading-options {\n    position: absolute;\n    background: white;\n    border-radius: 5px;\n    z-index: 9000000;\n    top: 100%;\n    border: 1px solid #e6e6e6;\n  }\n  .heading-option {\n    &:hover {\n      background: #f8f8f8;\n    }\n    padding: 7px;\n  }\n}\n</style>\n"],"names":["editor","ref","focused","showOptions","onMounted","checkClicks","onUnmounted","toggleOptions","__name","e","watch","props","value","Editor","StarterKit","Underline","Link","Code","Image","Placeholder","TextAlign","Heading","emit","onBeforeUnmount","availableHeadings","addImage","url","toggleLink","previousUrl","selectedHeading","computed"],"mappings":"k7BA+JMA,EAASC,EAAI,IAAI,EACjBC,EAAUD,EAAI,EAAK,EAyBnBE,EAAcF,EAAI,EAAK,EAE7BG,EAAU,IAAM,CACd,OAAO,iBAAiB,QAASC,CAAW,CAC9C,CAAC,EAEDC,GAAY,IAAM,CAChB,OAAO,oBAAoB,QAASD,CAAW,CACjD,CAAC,EAED,MAAME,EAAgBC,EAAA,IAAM,CAC1BL,EAAY,MAAQ,CAACA,EAAY,KACnC,EAFsB,iBAIhBE,EAAcG,EAACC,GAAM,CACrBN,EAAY,OAAS,CAACM,EAAE,OAAO,QAAQ,WAAW,IACpDN,EAAY,MAAQ,GAExB,EAJoB,eAMpBO,GACE,IAAMC,EAAM,WACXC,GAAU,CAEMZ,EAAO,MAAM,QAAO,IAAOY,GAS1CZ,EAAO,MAAM,SAAS,WAAWY,EAAO,EAAK,CAC9C,CACH,EAEAR,EAAU,IAAM,CACdJ,EAAO,MAAQ,IAAIa,EAAO,CACxB,QAAS,GACT,WAAY,CACVC,EACAC,EACAC,EACAC,EACAC,EACAC,EAAY,UAAU,CACpB,YAAaR,EAAM,WAC3B,CAAO,EACDS,EAAU,UAAU,CAClB,MAAO,CAAC,UAAW,WAAW,CACtC,CAAO,EACDC,EAAQ,UAAU,CAChB,OAAQ,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,CAAC,CACjC,CAAO,CACF,EACD,SAAU,IAAM,CAEdC,EAAK,oBAAqBtB,EAAO,MAAM,QAAS,CAAA,CAIjD,EACD,QAAS,IAAM,CAEbE,EAAQ,MAAQ,EACjB,EACD,OAAQ,IAAM,CAEZA,EAAQ,MAAQ,EACjB,CACL,CAAG,CACH,CAAC,EAEDqB,GAAgB,IAAM,CACpBvB,EAAO,MAAM,SACf,CAAC,EAED,MAAMwB,EAAoB,CAAC,EAAG,EAAG,EAAG,EAAG,CAAC,EAMlCC,EAAWjB,EAAA,IAAM,CACrB,MAAMkB,EAAM,OAAO,OAAO,sBAAsB,EAE5CA,GACF1B,EAAO,MAAM,MAAO,EAAC,MAAO,EAAC,SAAS,CAAE,IAAK0B,EAAK,EAAE,IAAG,CAE3D,EANiB,YAQXC,EAAanB,EAAA,IAAM,CACvB,GAAIR,EAAO,MAAM,SAAS,MAAM,EAC9BA,EAAO,MAAM,MAAO,EAAC,MAAK,EAAG,UAAS,EAAG,UACpC,CACL,MAAM4B,EAAc5B,EAAO,MAAM,cAAc,MAAM,EAAE,KACjD0B,EAAM,OAAO,OAAO,MAAOE,CAAW,EAG5C,GAAIF,IAAQ,KACV,OAIF,GAAIA,IAAQ,GAAI,CACd1B,EAAO,MAAM,MAAO,EAAC,MAAO,EAAC,gBAAgB,MAAM,EAAE,YAAY,MAEjE,MACD,CAGDA,EAAO,MACJ,MAAO,EACP,MAAO,EACP,gBAAgB,MAAM,EACtB,QAAQ,CAAE,KAAM0B,EAAK,EACrB,KACJ,CACH,EA3BmB,cA6BbG,EAAkBC,GAAS,IAC3B9B,EAAO,MAAM,SAAS,UAAW,CAAE,MAAO,CAAC,CAAE,EACxC,KACEA,EAAO,MAAM,SAAS,UAAW,CAAE,MAAO,CAAC,CAAE,EAC/C,KACEA,EAAO,MAAM,SAAS,UAAW,CAAE,MAAO,CAAC,CAAE,EAC/C,KACEA,EAAO,MAAM,SAAS,UAAW,CAAE,MAAO,CAAC,CAAE,EAC/C,KACEA,EAAO,MAAM,SAAS,UAAW,CAAE,MAAO,CAAC,CAAE,EAC/C,KACEA,EAAO,MAAM,SAAS,UAAW,CAAE,MAAO,CAAC,CAAE,EAC/C,KAEA,IAEV;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}